---
- hosts: manager_group worker_group
  become: true
  roles:
  - initial-setup
  - docker-install

- hosts: manager_group
  become: true
  roles:
  - swarm-init

- hosts: worker_group
  become: true
  roles:
  - swarm-join

- hosts: manager_group
  become: true
  roles:
  - clone-repo
  - build-images
  - swarm-stack

- hosts: load_balancer
  become: true
  roles:
  - load-balancer